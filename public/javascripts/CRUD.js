function addHabit(e,t){for(var a=getTitle(),n=getWeekFreq(),o=[],i=0;7>i;i++)o[i]=document.getElementById("date"+i).checked;var l=document.getElementById("others");""!=l.value&&(t=l.value);var r=window.localStorage.getItem("userID"),d=new Firebase("https://torrid-fire-6209.firebaseio.com/"),s=makeid(),c=d.child("users").child(r).child("habits").child(s),u=function(e){e?(console.log("Synchronization failed"),sendRollbarError("Synchronization failed"),document.getElementById("alert").innerHTML="** error saving habit please try again **"):(console.log("Synchronization succeeded"),mixpanel.track("Habit Added",{title:a,weeklyfrequency:{Sunday:o[0],Monday:o[1],Tuesday:o[2],Wednesday:o[3],Thursday:o[4],Friday:o[5],Saturday:o[6]},dailyfrequency:t,progress:0}),location.href="list.html")};""==a?document.getElementById("alert").innerHTML="** Please provide a title **":0==n.length?document.getElementById("alert").innerHTML="** Please provide a weekly frequency **":null==t?document.getElementById("alert").innerHTML="** Please provide a daily frequency **":c.set({title:a,weeklyfrequency:{Sunday:o[0],Monday:o[1],Tuesday:o[2],Wednesday:o[3],Thursday:o[4],Friday:o[5],Saturday:o[6]},dailyfrequency:t,progress:0},u)}function makeid(){for(var e="h",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=1;25>a;a++)e+=t.charAt(Math.floor(Math.random()*t.length));return e}function getTitle(){return document.getElementById("title").value}function getDayFreq(){day_freq=[];for(var e=document.getElementById("daily-button").getElementsByTagName("input"),t=0;t<e.length;t++)1==e[t].checked&&day_freq.push(e[t].text);return day_freq}function getWeekFreq(){week_freq=[];for(var e=document.getElementById("ck-button").getElementsByTagName("input"),t=0;t<e.length;t++)1==e[t].checked&&week_freq.push(e[t].value);return week_freq}function listHabits(){var e=window.localStorage.getItem("userID"),t=new Firebase("https://torrid-fire-6209.firebaseio.com"),a=t.child("users").child(e).child("habits");document.getElementById("habit-list");mixpanel.track("Habits Viewed"),a.once("value",function(e){e.forEach(function(e){console.log(e.val());var t=document.createElement("li");t.id=e.key();var a=e.val().progress,n=e.val().dailyfrequency,o=a/n*200;t.innerHTML='<ul class="habit-info"><li><div class="habit-name">'+e.val().title+'</div></li><li><img class="habit-icon" src="add.png" alt="habit icon"></li> </ul> <div class="message"> <span class="message-total"> <strong>2</strong> days in a row! Best Record: <strong>5</strong><br> <svg height="25" width="200"><line class="line1 " x1="0" y1="0" x2="'+o+'" y2="0" style="stroke:rgba(65, 131, 215, 0.8);stroke-width:25" /><line class="line2 " x1="'+o+'" y1="0" x2="200" y2="0" style="stroke:rgba(171,171,171,0.6);stroke-width:25" /></svg></span><br> <span class="message-today">Completed <strong>1/1</strong> for today!</span></div><div class="habit-op"><button type="button" class="op op-done" onclick="updateProgress(this);" title="done"><img src="done.svg" alt="Done"></button><button type="button" class="op op-edit" onclick="goToHabit(this);" title="edit habit"><img src="edit.svg" alt="Edit"></button><button type="button" class="op op-del" onclick="deleteHabit(this);" title="delete habit"><img src="delete.svg" alt="Del"></button></div></li>';var i=document.getElementById("habit-list");i.appendChild(t)})},function(e){console.log("The read failed: "+e.code),sendRollbarError("The read failed: "+e.code)})}function updateProgress(e){var t=e.parentNode.parentNode,a=window.localStorage.getItem("userID"),n=new Firebase("https://torrid-fire-6209.firebaseio.com"),o=n.child("users").child(a).child("habits");o.once("value",function(a){a.forEach(function(a){var n=e.parentNode.parentNode.getElementsByClassName("message-today")[0],i=a.val().progress+1,l=a.val().dailyfrequency,r=i/l*200;if(console.log(l),console.log(i),l>=i){var d=e.parentNode.parentNode.getElementsByClassName("line1")[0];d.setAttribute("x2",r);var s=e.parentNode.parentNode.getElementsByClassName("line2")[0];s.setAttribute("x1",r),n.innerHTML="Completed <strong>"+i+"/"+l+"</strong> for today!",n.style.visibility="visible";var c=function(e){e?(console.log("Synchronization failed"),sendRollbarError("Synchronization failed")):console.log("Synchronization succeeded")},u=o.child(t.id);u.update({progress:i},c)}else n.innerHTML="Completed for today!",n.style.visibility="visible"})},function(e){console.log("The read failed: "+e.code),sendRollbarError("The read failed: "+e.code)})}function removeHabit(e){console.log(e);var t=window.localStorage.getItem("userID"),a=new Firebase("https://torrid-fire-6209.firebaseio.com"),n=a.child("users").child(t).child("habits"),o=n.child(e),i=function(e){e?(console.log("Synchronization failed"),sendRollbarError("Synchronization failed")):(console.log("Synchronization succeeded"),mixpanel.track("Habit Deleted"))};o.remove(i)}function goToHabit(e){var t=e.parentNode.parentNode;window.localStorage.setItem("habitKey",t.id),location.href="edit.html",console.log(key)}function updateHabit(e){var t=window.localStorage.getItem("habitKey");console.log(t);for(var a,n=document.getElementById("title-top").value,o=getBase64Image(e),i=1;3>=i;i++)1==document.getElementById("day"+i).checked&&(a=i);var l=document.getElementById("others").value;""!=l&&(a=l);for(var r=[],i=0;7>i;i++)r[i]=document.getElementById("date"+i).checked;var d=window.localStorage.getItem("userID"),s=new Firebase("https://torrid-fire-6209.firebaseio.com"),c=s.child("users").child(d).child("habits"),u=c.child(t),y=function(e){e?(console.log("Synchronization failed"),sendRollbarError("Synchronization failed")):(console.log("Synchronization succeeded"),mixpanel.track("Habit Updated",{title:n,icon:o,weeklyfrequency:{Sunday:r[0],Monday:r[1],Tuesday:r[2],Wednesday:r[3],Thursday:r[4],Friday:r[5],Saturday:r[6]},dailyfrequency:a}))};u.update({title:n,icon:o,weeklyfrequency:{Sunday:r[0],Monday:r[1],Tuesday:r[2],Wednesday:r[3],Thursday:r[4],Friday:r[5],Saturday:r[6]},dailyfrequency:a},y),location.href="list.html"}function getBase64Image(e){if(null!=e){var t=document.createElement("canvas");t.width=e.clientWidth,t.height=e.clientHeight;var a=t.getContext("2d");a.drawImage(e,0,0,e.clientWidth,e.clientHeight);var n=t.toDataURL("image/png");return n}document.getElementById("alert").innerHTML="** Please select an icon **"}